{{TAGDEF|HFRCUT|[real]|0}}

Description: {{TAG|HFRCUT}} specifies how the [[Coulomb singularity|Coulomb kernel is approximated at G=0]] when the Fock energy and the exchange potential are evaluated.
----

In systems with periodic boundary conditions, the Coulomb energy and the Coulomb potential are usually evaluated under the assumption of a compensating background by introducing a compensation charge density. This is well-justified for the Hartree energy, where the compensation charge density stems from the ions. Yet, this assumption is not valid for the Fock exchange, which causes an error. For the Fock exchange potential and energy, one can correct the resulting error by assuming that the density matrix is local. The leading order correction is given by the difference between the electrostatic energy of a localized model charge density in a homogeneous background periodically repeated and the same model charge density in isolation. For details we refer to J. Paier ''et al.,''{{cite|paier:jcp:05}} Section II. D. 4.

*{{TAG|HFRCUT}} = 0: Ewald summation ''or'' method of Massida, Posternak, and Baldereschi depending on k-mesh{{cite|gygi:prb:86}}{{cite|massidda:prb:93}}
:If a regular automatic k-mesh and the standard 1/r Coulomb kernel are used, the correction is computed using Ewald summations. If the k-mesh is ''not'' regular (e.g., if the k-points are explicitly listed in the {{FILE|KPOINTS}} file) or if kernels different from the bare Coulomb kernel are used (e.g., HSE functional), the method of Massida, Posternak, and Baldereschi{{cite|gygi:prb:86}}{{cite|massidda:prb:93}} is used. This approach assumes that the model charge density is an error-function-like charge distribution in real space in order to handle the long-range nature of the potential in reciprocal space. It requires setting a decay constant for the error function, see {{TAG|HFALPHA}}. Both methods, the Ewald summation and the method of Massida, Posternak, and Baldereschi, are strictly equivalent for regular k-mesh.

*{{TAG|HFRCUT}} = -1: Automated cutoff radius{{cite|spenceralavi:prb:08}}
:An alternative recipe is to replace the 1/r Coulomb kernel with a truncated Coulomb kernel that is strictly zero beyond a certain cutoff radius. If {{TAG|HFRCUT}} is set to -1, the radial cutoff is chosen to be equivalent to the radius of the sphere with a volume of the unit cell times the total number of k-points in the full Brillouin zone. For instance, for a  4x4x4 k-point grid, that yields 64 times the volume of the unit cell.

*{{TAG| HFRCUT}} = [cutoff radius]: Manually set cutoff radius in Ångström.

In the limit of many k-points, both methods ({{TAG|HFRCUT}}=-1 and {{TAG|HFRCUT}}=0) should yield identical results. In our experience, the {{TAG|HFRCUT}}=-1 converges more rapidly for systems with a gap, as well as molecules and atoms, whereas {{TAG|HFRCUT}}=0 converges faster for metallic systems. It is expedient to first converge the energies with respect to the number of k-points for both methods and then select for subsequent calculations the method that converges more rapidly. A detailed comparison of the convergence of the different methods for metallic and gapped materials was made by Sundararaman and Arias{{cite|sundararamanarias:prb:13}}.

== Related tags and articles ==
{{TAG|AEXX}},
{{TAG|AGGAX}},
{{TAG|AGGAC}},
{{TAG|ALDAC}},
{{TAG|HFALPHA}},
{{TAG|LTHOMAS}},
[[List of hybrid functionals]],
[[Hybrid_functionals:_formalism|Hybrid functionals: formalism]],
[[Coulomb singularity]]

{{sc|HFRCUT|Examples|Examples that use this tag}}
== References ==
<references/>
----

[[Category:INCAR tag]][[Category:Exchange-correlation functionals]][[Category:Hybrid_functionals]]
